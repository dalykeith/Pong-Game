<!DOCTYPE html>
<!--
Author: Keith Daly
ID: G00315960
Graphics Programming GMIT 2017
-->
<html>

<!-- Game Presets to change

Beginer mode:
Please change ballSpeedX 5
and change paddleH 250

Intermediate mode:
Please change ballSpeedX 12
and change paddleH 100

Advanced Mode:
Please change ballSpeedX 25
and change paddleH 40

-->

<body>
    <canvas id="titleInfo" width="800" height="70"style="border:1px solid #d3d3d3;"></canvas>
    <script>
    var c = document.getElementById("titleInfo");
    var ctx = c.getContext("2d");
    ctx.font = "20px Georgia";
    ctx.fillText("Pong Game", 25, 40);
    ctx.fillText("User vs CPU", 650, 40);
    </script>

<canvas id="projectPong" width="800" height="600"></canvas>
<script>
var canvas;
var canvasCtx;
var ballX = 50;
var ballY = 50;


//Ball Speed (Mode:)
// var ballSpeedX = 5;
var ballSpeedX = 12;
// var ballSpeedX = 25;
var ballSpeedY = 7;

var paddle1Y = 250; //left paddle
var paddle2Y = 250; //right paddle
const paddleH = 100; //set paddle height
const paddleT = 10; //set paddle thickness

// Adapted from: https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent
// https://developer.mozilla.org/en-US/docs/Games/Techniques/Control_mechanisms/Desktop_with_mouse_and_keyboard
function calcMousePos(evt) {
	var rect = canvas.getBoundingClientRect();
	var root = document.documentElement;
	var mouseX = evt.clientX - rect.left - root.scrollLeft;
	var mouseY = evt.clientY - rect.top - root.scrollTop;
	return {
		x:mouseX,
		y:mouseY
	};
}


window.onload = function() {
	// console.log("test");
	canvas = document.getElementById('projectPong');
	canvasCtx = canvas.getContext('2d');

    var framesPerSecond = 30;
    setInterval(callBF, 1000/framesPerSecond);

    canvas.addEventListener('mousemove',
		function(evt) {
			var mousePos = calcMousePos(evt);
			paddle1Y = mousePos.y - (paddleH/2);
		});
	
}
function ballReset() {
    ballSpeedX = - ballSpeedX; //this is added so it changes direction per each reset
    ballX = canvas.width/2;
    ballY = canvas.height/2;
}
function callBF(){ //calls both functions
    draw(); 
    movement();
}
function cpuMvmt(){
    if (paddle2Y < ballY){
        paddle2Y += 6;
    } else{
        paddle2Y -= 6;
    }
}


function movement(){
        cpuMvmt();
        ballX += ballSpeedX;
        ballY += ballSpeedY; //ballY = ballY + ballSpeedY;
        if(ballX < 0){ 
            if(ballY > paddle1Y && ballY < paddle1Y+ paddleH){
                ballSpeedX = -ballSpeedX;
            } else {
            ballReset(); //if ball goes into left side void, it will be center reset
        }}
        if(ballX > canvas.width){
            if(ballY > paddle2Y && ballY < paddle2Y+ paddleH){
                ballSpeedX = -ballSpeedX;
            } else {
            ballReset();
        }}
        if(ballY < 0){
            ballSpeedY = - ballSpeedY;
        }
        if(ballY > canvas.height){
            ballSpeedY = - ballSpeedY;
        }
}

function draw(){
    //draws next line blacked out
	colorRect(0,0,canvas.width,canvas.height, 'black');
    
    //Draws left player rectangle (Modes:)
    // colorRect(0,paddle1Y,10,200,'white');
    colorRect(0,paddle1Y,paddleT,paddleH,'white');
    // colorRect(0,paddle1Y,10,50,'white'); 

    //right side player CPU
    colorRect(canvas.width -paddleT,paddle2Y,paddleT,paddleH,'white');

    //draws Ball
    colorCircle(ballX, ballY,10, 'white')
    
}

function colorCircle(centerX, centerY, radius, drawColor){
    canvasCtx.fillStyle = 'drawColor';
    canvasCtx.beginPath();
    canvasCtx.arc(centerX,centerY,radius,0,Math.PI*2,true);
    canvasCtx.fill();
}
function colorRect(leftX,topY, width,height, drawColor){
    canvasCtx.fillStyle = drawColor;
	canvasCtx.fillRect(leftX,topY, width,height);
}

</script>
    
</body>
</html>